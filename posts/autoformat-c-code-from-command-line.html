<!DOCTYPE html>
<html lang="en">
<head>
          <title>Ha.Minh's Blog</title>
        <meta charset="utf-8" />
        <link href="http://minhhh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ha.Minh's Blog Full Atom Feed" />
        <link href="http://minhhh.github.io/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="Ha.Minh's Blog Categories Atom Feed" />



    <meta name="tags" contents="c#" />
    <meta name="tags" contents="cli" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://minhhh.github.io/">Ha.Minh's Blog <strong>Software development and other stuff</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="http://minhhh.github.io/pages/about">About</a></li>
            <li><a href="http://minhhh.github.io/pages/projects">Projects</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://minhhh.github.io/posts/autoformat-c-code-from-command-line" rel="bookmark"
         title="Permalink to Autoformat C# code from command line">Autoformat C# code from command line</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2016-09-11T00:00:00">
      Sun 11 September 2016
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="http://minhhh.github.io/author/haminh.html">Ha.Minh</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>We all need a tool to format code automatically according to project's convention. Using an IDE like Visual Studio, Xamarin or MonoDevelop, we can format code easily. However, it's not always convenient to fireup the IDE just for formatting some code, and also having a tool on the command line makes it easier to integrate with other workflows. Therefore, it's great if we have some tool which runs on the command line to auto format our code.</p>
<p><strong>Requirements</strong>
<em> Customizable format options
</em> Format whole directory recursively</p>
<p>The second requirement is relatively easy to implement if we have a tool to format a single file on the commandline because we can just use <code>find</code> with some filter to iteratively apply the tool to a bunch of files.</p>
<h2>Solution 1: Astyle</h2>
<p><a href="http://astyle.sourceforge.net/">Artistic Style</a> is a source code indenter, formatter, and beautifier for the C, C++, C++/CLI, Objectiveâ€‘C, C# and Java programming languages. We can download and install Astyle rather quickly without any problems on most platforms.</p>
<p><strong>Installation</strong>
We will use a simple script below to help us install AStyle on Mac OSX. Installation on other platforms can be done in a similar manner</p>
<p><div>
    <style type = "text/css" scoped>
.git-content div {
    padding: 0;
    margin: 0;
}

.git-content .git-file {
    border: 1px solid #DEDEDE;
    margin-bottom: 1em;
}

.git-content .git-file .git-meta {
    background-color: #EAEAEA;
    color: #666666;
    font-size: 85%;
    overflow: hidden;
    padding: 0.5em;
}

.git-content .git-file .git-meta a {
    color: #336699;
}

.git-content .git-file .git-meta a:visited {
    color: #773377;
}

.git-content .git-file {
    background-color: #F8F8FF;
    border-bottom: 1px solid #DDDDDD;
    font-size: 100%;
    overflow: auto;
    word-wrap: normal;
}

.git-content .git-file pre {
    background: none repeat scroll 0 0 transparent !important;
    border: medium none !important;
    margin: 0 !important;
    padding: 0 !important;
}
    </style>
    <div class="git-content">
        <div class="git-file">
            <div class="file">
 <div class="blob-wrapper data type-shell" itemprop="text">
  <table class="highlight tab-size js-file-line-container" data-tab-size="8">
   <tr>
    <td class="blob-num js-line-number" data-line-number="1" id="L1">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC1">
     <span class="pl-c">
      <span class="pl-c">
       #!
      </span>
      /bin/sh
     </span>
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="2" id="L2">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC2">
     <span class="pl-c1">
      set
     </span>
     -eu
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="3" id="L3">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC3">
     <span class="pl-c1">
      cd
     </span>
     /tmp/
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="4" id="L4">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC4">
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="5" id="L5">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC5">
     curl -L -o astyle.tar.gz http://sourceforge.net/projects/astyle/files/astyle/astyle%202.05.1/astyle_2.05.1_macosx.tar.gz/download
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="6" id="L6">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC6">
     tar zxvf astyle.tar.gz
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="7" id="L7">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC7">
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="8" id="L8">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC8">
     <span class="pl-c1">
      cd
     </span>
     astyle
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="9" id="L9">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC9">
     <span class="pl-c1">
      cd
     </span>
     build/xcode
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="10" id="L10">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC10">
     sudo xcodebuild install -project AStyle.xcodeproj
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="11" id="L11">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC11">
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="12" id="L12">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC12">
     <span class="pl-c1">
      cd
     </span>
     ../../build/mac/
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="13" id="L13">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC13">
     make
    </td>
   </tr>
   <tr>
    <td class="blob-num js-line-number" data-line-number="14" id="L14">
    </td>
    <td class="blob-code blob-code-inner js-file-line" id="LC14">
     sudo make install
    </td>
   </tr>
  </table>
 </div>
</div>

            <div class="git-meta">
                
                <span>Brought to you by me <a href="https://github.com/minhhh/pelican_git">pelican_git</a>.</span>
                
                <span style="float: right; color: #369;"><a href="https://github.com/minhhh/dev-tools/blob/master/astyle/setup_astyle.sh">view original</a></span>
                <span style="float: right; margin-right: 8px;">
                    <a style="color: rgb(102, 102, 102);" href="https://github.com/minhhh/dev-tools/blob/master/astyle/setup_astyle.sh">astyle/setup_astyle.sh</a></span>
            </div>
        </div>
    </div>
</div></p>
<p><strong>Usage</strong>
After we have <code>astyle</code> available on the command line, applying it for our project is a matter of wrapping everything in a single Make command like so</p>
<div class="codehilite"><pre><span></span># Supposed our Code is in the Code folder
format:
    find Code -iname &quot;*.cs&quot; -not -path &quot;Code/excludedpath/*&quot; | xargs -n 1 -I {} bash -c &quot;astyle --options=.astylerc \&quot;{}\&quot;&quot;
</pre></div>


<p>Remember to create a file called <code>.astylerc</code> and put whatever format options you want to customize for your project there.</p>
<h2>Solution 2: NRefactory</h2>
<p><a href="https://github.com/icsharpcode/NRefactory">NRefactory</a> is the C# analysis library used in the SharpDevelop and MonoDevelop IDEs. We can write a command line client with our customized parameters and format options, which uses <code>NRefactory</code> internally to format code.</p>
<p>TODO: Write a cli using <code>docopt</code></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>