<!DOCTYPE html>
<html lang="en">
<head>
          <title>Ha.Minh's Blog</title>
        <meta charset="utf-8" />
        <link href="http://minhhh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ha.Minh's Blog Full Atom Feed" />
        <link href="http://minhhh.github.io/feeds/unity.atom.xml" type="application/atom+xml" rel="alternate" title="Ha.Minh's Blog Categories Atom Feed" />



    <meta name="tags" contents="unity" />
    <meta name="tags" contents="texture" />
    <meta name="tags" contents="splitalpha" />
    <meta name="tags" contents="optimization" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://minhhh.github.io/">Ha.Minh's Blog <strong>Software development and other stuff</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="http://minhhh.github.io/pages/about">About</a></li>
            <li><a href="http://minhhh.github.io/pages/projects">Projects</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://minhhh.github.io/posts/unity-texture-compression-and-optimization" rel="bookmark"
         title="Permalink to Unity Texture compression and optimization">Unity Texture compression and optimization</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2016-12-03T00:01:00">
      Sat 03 December 2016
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="http://minhhh.github.io/author/haminh.html">Ha.Minh</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>A common question when building Unity games is which texture compression format will be the best. The criteria are: size on disk, memory footprint, performance.</p>
<p>We have many options in the Unity Engine: ETC1, ETC2, DXT3, DXT5, and so on. How do we choose? Let's look at some optimization tricks to see how others choose their formats.</p>
<p>First you need to understand <a href="http://gamedev.stackexchange.com/questions/5171/how-much-memory-does-a-texture-take-up-on-the-gpu">How much memory does a texture take up on the GPU?</a></p>
<ul>
<li>many modern engines opt to store the same format on disk as they do in memory, leading to files that are the same size as the texture's memory requirements</li>
<li>Uncompresed image of 256x256 is 256KB. A DXT1 image of 256x256 is 32KB. And DXT3 or DXT5 is 64KB</li>
<li><a href="http://mainroach.blogspot.com/2014/03/the-png-vs-gpu-battle-on-android.html">http://mainroach.blogspot.com/2014/03/the-png-vs-gpu-battle-on-android.html</a> also explains why you don't want to use plain <code>png</code> textures. Instead, export them to <code>DXT1</code>, <code>PVR</code> or <code>ETC</code></li>
</ul>
<p><a href="https://web.archive.org/web/20160826092252/http://android-developers.blogspot.com/2015/01/efficient-game-textures-with-hardware.html">Efficient Game Textures with Hardware Compression</a> examines preferable compression formats which are supported on the GPU to help you reduce .apk size and loading times of your game:</p>
<ul>
<li>As you can see, with higher OpenGL support you gain access to better formats. There are proprietary formats to replace ETC1, delivering higher quality and alpha channel support. These are shown in the following table:<ul>
<li>ATC   Available with Adreno GPU.</li>
<li>PVRTC Available with a PowerVR GPU.</li>
<li>DXT1  S3 DXT1 texture compression. Supported on devices running Nvidia Tegra platform.</li>
<li>S3TC  S3 texture compression, nonspecific to DXT variant. Supported on devices running Nvidia Tegra platform.</li>
</ul>
</li>
<li>Using hardware accelerated textures in your games will help you reduce the size of your .apk, runtime memory use as well as loading times.</li>
</ul>
<p><a href="https://web.archive.org/web/20160507141202/http://biobeasts.artix.com/unity-2d-texture-optimization/">Unity 2D Texture Optimization</a> explains how they group textures by type instead of logical groups to save memory:</p>
<ul>
<li>2048x2048 sprite sheet above, even with compression applied, took up 4mb in Texture2D memory</li>
<li>assets fail to render and appear like black shapes</li>
<li>organize sprite sheets into three compression types: Solids, Fades, and Alpha Punchouts.</li>
<li>Solids are any rectangular assets with NO alpha. Here we can get a major savings by selecting a 4-bit compression that doesn't support alpha.</li>
<li>Alpha Punchouts are any other shapes that use binary alpha, meaning the area of the image is either 100% or 0% alpha. Here we select a 5-bit compression</li>
<li>Fades are reserved for our most complex objects that contain variable degrees of alpha. We use these sparingly and compress them using a minimum of 8-bit RGBA to look best.</li>
</ul>
<p><a href="https://web.archive.org/web/20160513225925/http://forum.unity3d.com/threads/etc1-vs-etc2-texture-compression.219842/">ETC1 vs ETC2 vs DXT5</a> discuss which is the best texture format</p>
<ul>
<li>ETC2 only for devices supporting ES 3.0</li>
<li>But if your targeting all devices... which u should consider doing in 2015, then it doesnt matter if you pick ETC2 or DXT5 Crunched because theyre both getting decompressed. Which makes sense for ARGB. And then for RGB just ETC1</li>
<li>Most devices support ETC1 <a href="http://developer.android.com/guide/topics/graphics/opengl.html#textures">http://developer.android.com/guide/topics/graphics/opengl.html#textures</a></li>
<li>I was able to remove 25% of my file size this weekend, thanks to switching to ETC1 + DXT5 Crunched</li>
</ul>
<p><a href="https://web.archive.org/web/20150610061237/https://software.intel.com/en-us/articles/android-texture-compression-a-comparison-study-with-code-sample">Android Texture Compression - a comparison study with code sample</a> compares the quality and sizes of different formats on Android devices including: <code>png, etc, etc2, pvrtc and s3tc</code>.</p>
<p><a href="https://web.archive.org/web/20160513225136/http://forum.unity3d.com/threads/etc2-as-default-texture-compression-on-android.348582/">ETC2 as default texture compression on Android</a> discuss usage of ETC2 format</p>
<ul>
<li>We use DXT5 on our sprites to save space on apk file. When the device does not support your texture type, Unity uses software decompression on load and your textures become 32bit RGBA.</li>
<li>Use ETC2 to save memory. It might be bad for some low-spec device if they don't support ETC2. Also one more reason to pack your own sheets instead of using Unity packer, since you can do dithering yourself</li>
</ul>
<p>Some texture optimization recommendations</p>
<ul>
<li>Don't use mipmap for 2D <a href="https://web.archive.org/web/20160422114629/http://forum.unity3d.com/threads/is-it-possible-to-turn-on-mip-maps-for-a-sprite.219054/">Is it possible to turn on Mip Maps for a sprite</a></li>
<li>Compress your textures to DXT1 or DXT5 <a href="https://web.archive.org/web/20160428065248/http://forum.unity3d.com/threads/tips-and-tricks-make-sure-to-profile-your-phone-apps-memory-usage.202952/">Memory optimization tricks</a></li>
<li><a href="https://web.archive.org/web/20160520084556/http://forum.unity3d.com/threads/what-resolution-should-i-be-painting-sprites-in.225845/">What Resolution should I be painting sprites in?</a> 2048x2048 seems a bit big already on mobile device</li>
</ul>
<p><a href="https://support.unity3d.com/hc/en-us/articles/207051116-How-can-I-add-Alpha-to-ETC1-Compression-">How Can I Add Alpha To ETC1 Compression?</a> attempts to answer the question about ETC1 + Alpha channel</p>
<ul>
<li>Sprites placed on some atlas by specifying them with a packing tag</li>
<li>Make sure to mark the Override for Android checkbox as well as the Compress using ETC1 checkbox. Unity will split the resulting atlas into two textures, each without Alpha and then combine them in the final parts of the RenderPipeline.</li>
<li>The UI shaders in Unity 5.3.0 and earlier do not support ETC1 + Alpha</li>
<li>Yes. The UI elements do not work well with ETC1. We have a bug on it. (http://forum.unity3d.com/threads/etc1-alpha-feature.350184/)</li>
</ul>
<p><a href="https://web.archive.org/web/20160726041743/http://developers.mobage.jp/blog/texture-compression">Unity mobile Splitalpha</a>. This blogs has solved the issue with ETC1 + Alpha and provided a solution for both Android and iOS devices.</p>
<ul>
<li>ETC1 with Alpha channel splitalpha<ul>
<li>Split Alpha texture</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span>                        合計サイズ (MiB) RGBA       16bit 比のサイズ削減率 (%)
RGBA 16bit              879                         0
RGBA PVRTC 4bit         229                         74
RGBA ETC2 8bit          431                         51
Split Alpha (Android)   249                         72
Split Alpha (iOS)       272                         69
</pre></div>


<ul>
<li>https://github.com/keijiro/unity-alphamask</li>
</ul>
<p>In conclusion, use ETC + Alpha channel whenever you can because it provides the best build size and memory footprint in most cases, at reasonable quality.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>